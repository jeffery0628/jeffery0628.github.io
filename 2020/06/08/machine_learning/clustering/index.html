<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/snoppy.jpeg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/snoppy.jpeg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/snoppy.jpeg">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open Sans:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/pace-js@1/themes/blue/pace-theme-minimal.css">
  <script src="//cdn.jsdelivr.net/npm/pace-js@1/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"jeffery.ink","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"hide","padding":15,"offset":12,"onmobile":true,"dimmer":true},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"valine","storage":true,"lazyload":true,"nav":null,"activeClass":"valine"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":3,"unescape":true,"preload":true},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta property="og:type" content="article">
<meta property="og:title" content="èšç±»ç®—æ³•">
<meta property="og:url" content="https://jeffery.ink/2020/06/08/machine_learning/clustering/index.html">
<meta property="og:site_name" content="ç«ç§2å·">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://jeffery.ink/2020/06/08/machine_learning/clustering/v2-99863816ea8d29383c5ff28a8b7a667e_1440w.jpg">
<meta property="og:image" content="https://jeffery.ink/2020/06/08/machine_learning/clustering/00630Defly1g5b746zwjgj30fh0c7gnj.jpg">
<meta property="og:image" content="https://jeffery.ink/2020/06/08/machine_learning/clustering/00630Defly1g5b7pbaeavj30qo0cwtc9.jpg">
<meta property="og:image" content="https://jeffery.ink/2020/06/08/machine_learning/clustering/00630Defly1g5b8mu9mjmj30iu0apjuh.jpg">
<meta property="og:image" content="https://jeffery.ink/2020/06/08/machine_learning/clustering/00630Defly1g5b8ms101aj30id0aswhh.jpg">
<meta property="article:published_time" content="2020-06-08T12:27:00.000Z">
<meta property="article:modified_time" content="2020-08-11T14:13:02.083Z">
<meta property="article:author" content="Li Zhen">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://jeffery.ink/2020/06/08/machine_learning/clustering/v2-99863816ea8d29383c5ff28a8b7a667e_1440w.jpg">

<link rel="canonical" href="https://jeffery.ink/2020/06/08/machine_learning/clustering/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>èšç±»ç®—æ³• | ç«ç§2å·</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">ç«ç§2å·</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">ç«ç§è®¡åˆ’</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>ç®€å†</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
        <li class="menu-item menu-item-books">

    <a href="/books/" rel="section"><i class="fa fa-book fa-fw"></i>è¯»ä¹¦</a>

  </li>
        <li class="menu-item menu-item-movies">

    <a href="/movies/" rel="section"><i class="fa fa-video fa-fw"></i>ç”µå½±</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>



</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jeffery.ink/2020/06/08/machine_learning/clustering/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/snoppy.jpeg">
      <meta itemprop="name" content="Li Zhen">
      <meta itemprop="description" content="ä»–ï¼Œä¸è®ºåœ¨æˆå¹´è¿˜æ˜¯åœ¨å°æ—¶å€™ï¼Œå¿…é¡»è¸ä¸Šä¸€æ¡æä¸ºè‰°è‹¦çš„é“è·¯ï¼Œä¸è¿‡è¿™æ˜¯ä¸€æ¡æœ€å¯é çš„é“è·¯ã€‚">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ç«ç§2å·">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          èšç±»ç®—æ³•
        </h1>

        <div class="post-meta">
          
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-08-11 22:13:02" itemprop="dateModified" datetime="2020-08-11T22:13:02+08:00">2020-08-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%8A%80%E6%9C%AF-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index"><span itemprop="name">æŠ€æœ¯/æœºå™¨å­¦ä¹ </span></a>
                </span>
            </span>

          
            <span id="/2020/06/08/machine_learning/clustering/" class="post-meta-item leancloud_visitors" data-flag-title="èšç±»ç®—æ³•" title="é˜…è¯»æ¬¡æ•°">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">è¯„è®ºï¼š</span>
    
    <a title="valine" href="/2020/06/08/machine_learning/clustering/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/06/08/machine_learning/clustering/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>9.3k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>8 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p><img src="/2020/06/08/machine_learning/clustering/v2-99863816ea8d29383c5ff28a8b7a667e_1440w.jpg" alt></p>
<a id="more"></a>
<h1 id="ju-lei-suan-fa-du-shi-wu-jian-du-xue-xi-ma">èšç±»ç®—æ³•éƒ½æ˜¯æ— ç›‘ç£å­¦ä¹ å—?</h1>
<p>ä»€ä¹ˆæ˜¯èšç±»ç®—æ³•ï¼Ÿ</p>
<p>èšç±»æ˜¯ä¸€ç§æœºå™¨å­¦ä¹ æŠ€æœ¯ï¼Œå®ƒæ¶‰åŠåˆ°æ•°æ®ç‚¹çš„åˆ†ç»„ã€‚ç»™å®šä¸€ç»„æ•°æ®ç‚¹ï¼Œå¯ä»¥ä½¿ç”¨èšç±»ç®—æ³•å°†æ¯ä¸ªæ•°æ®ç‚¹åˆ’åˆ†ä¸ºä¸€ä¸ªç‰¹å®šçš„ç»„ã€‚ç†è®ºä¸Šï¼ŒåŒä¸€ç»„ä¸­çš„æ•°æ®ç‚¹åº”è¯¥å…·æœ‰ç›¸ä¼¼çš„å±æ€§æˆ–ç‰¹å¾ï¼Œè€Œä¸åŒç»„ä¸­çš„æ•°æ®ç‚¹åº”è¯¥å…·æœ‰é«˜åº¦ä¸åŒçš„å±æ€§æˆ–ç‰¹å¾ã€‚<strong>èšç±»æ˜¯ä¸€ç§æ— ç›‘ç£å­¦ä¹ çš„æ–¹æ³•</strong>ï¼Œæ˜¯è®¸å¤šé¢†åŸŸä¸­å¸¸ç”¨çš„ç»Ÿè®¡æ•°æ®åˆ†ææŠ€æœ¯ã€‚</p>
<p>å¸¸ç”¨çš„ç®—æ³•åŒ…æ‹¬<strong>K-meansã€é«˜æ–¯æ··åˆæ¨¡å‹ï¼ˆGMMï¼‰ã€è‡ªç»„ç»‡æ˜ å°„ç¥ç»ç½‘ç»œï¼ˆSOMï¼‰</strong></p>
<h1 id="k-means-suan-fa">k-meansç®—æ³•</h1>
<h2 id="suan-fa-guo-cheng">ç®—æ³•è¿‡ç¨‹</h2>
<p>K-å‡å€¼æ˜¯æœ€æ™®éçš„èšç±»ç®—æ³•ï¼Œç®—æ³•æ¥å—ä¸€ä¸ªæœªæ ‡è®°çš„æ•°æ®é›†ï¼Œç„¶åå°†æ•°æ®èšç±»æˆä¸åŒçš„ç»„ã€‚</p>
<p>K-å‡å€¼æ˜¯ä¸€ä¸ªè¿­ä»£ç®—æ³•ï¼Œå‡è®¾æˆ‘ä»¬æƒ³è¦å°†æ•°æ®èšç±»æˆ n ä¸ªç»„ï¼Œå…¶æ–¹æ³•ä¸º:</p>
<ul>
<li>é¦–å…ˆé€‰æ‹©ğ¾ä¸ªéšæœºçš„ç‚¹ï¼Œç§°ä¸ºèšç±»ä¸­å¿ƒï¼ˆcluster centroidsï¼‰ï¼›</li>
<li>å¯¹äºæ•°æ®é›†ä¸­çš„æ¯ä¸€ä¸ªæ•°æ®ï¼ŒæŒ‰ç…§è·ç¦»ğ¾ä¸ªä¸­å¿ƒç‚¹çš„è·ç¦»ï¼Œå°†å…¶ä¸è·ç¦»æœ€è¿‘çš„ä¸­å¿ƒç‚¹å…³è”èµ·æ¥ï¼Œä¸åŒä¸€ä¸ªä¸­å¿ƒç‚¹å…³è”çš„æ‰€æœ‰ç‚¹èšæˆä¸€ç±»ã€‚</li>
<li>è®¡ç®—æ¯ä¸€ä¸ªç»„çš„å¹³å‡å€¼ï¼Œå°†è¯¥ç»„æ‰€å…³è”çš„ä¸­å¿ƒç‚¹ç§»åŠ¨åˆ°å¹³å‡å€¼çš„ä½ç½®ã€‚</li>
<li>é‡å¤æ­¥éª¤ï¼Œç›´è‡³ä¸­å¿ƒç‚¹ä¸å†å˜åŒ–ã€‚</li>
</ul>
<p>ç”¨  \(u^1,u^2,...,u^k\) æ¥è¡¨ç¤ºèšç±»ä¸­å¿ƒï¼Œç”¨\(ğ‘(1),ğ‘(2),...,ğ‘(ğ‘š)\)æ¥å­˜å‚¨ä¸ç¬¬\(ğ‘–\)ä¸ªå®ä¾‹æ•°æ®æœ€è¿‘çš„èšç±»ä¸­å¿ƒçš„ç´¢å¼•ï¼ŒK-å‡å€¼ç®—æ³•çš„ä¼ªä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Repeat &#123;</span><br><span class="line">    <span class="keyword">for</span> i = <span class="number">1</span> <span class="keyword">to</span> m</span><br><span class="line">    c(i) := <span class="keyword">index</span> (form <span class="number">1</span> <span class="keyword">to</span> K) <span class="keyword">of</span> <span class="keyword">cluster</span> centroid closest <span class="keyword">to</span> x(i)</span><br><span class="line">    <span class="keyword">for</span> k = <span class="number">1</span> <span class="keyword">to</span> K</span><br><span class="line">    Î¼k := average (mean) <span class="keyword">of</span> points assigned <span class="keyword">to</span> <span class="keyword">cluster</span> k</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç®—æ³•åˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤ï¼Œç¬¬ä¸€ä¸ª for å¾ªç¯æ˜¯èµ‹å€¼æ­¥éª¤ï¼Œå³ï¼šå¯¹äºæ¯ä¸€ä¸ªæ ·ä¾‹\(ğ‘–\)ï¼Œè®¡ç®—å…¶åº”è¯¥å±äºçš„ç±»ã€‚ç¬¬äºŒä¸ª for å¾ªç¯æ˜¯èšç±»ä¸­å¿ƒçš„ç§»åŠ¨ï¼Œå³ï¼šå¯¹äºæ¯ä¸€ä¸ªç±»\(k\)ï¼Œé‡æ–°è®¡ç®—è¯¥ç±»çš„è´¨å¿ƒã€‚</p>
<p>K-å‡å€¼ç®—æ³•ä¹Ÿå¯ä»¥å¾ˆä¾¿åˆ©åœ°ç”¨äºå°†æ•°æ®åˆ†ä¸ºè®¸å¤šä¸åŒç»„ï¼Œå³ä½¿åœ¨æ²¡æœ‰éå¸¸æ˜æ˜¾åŒºåˆ†çš„ç»„ç¾¤çš„æƒ…å†µä¸‹ä¹Ÿå¯ä»¥ã€‚ä¸‹å›¾æ‰€ç¤ºçš„æ•°æ®é›†åŒ…å«èº«é«˜å’Œä½“é‡ä¸¤é¡¹ç‰¹å¾æ„æˆçš„ï¼Œåˆ©ç”¨ K-å‡å€¼ç®—æ³•å°†æ•°æ®åˆ†ä¸ºä¸‰ç±»ï¼Œç”¨äºå¸®åŠ©ç¡®å®šå°†è¦ç”Ÿäº§çš„ T-æ¤è¡«çš„ä¸‰ç§å°ºå¯¸ã€‚</p>
<p><img src="/2020/06/08/machine_learning/clustering/00630Defly1g5b746zwjgj30fh0c7gnj.jpg" alt></p>
<h2 id="sun-shi-han-shu">æŸå¤±å‡½æ•°</h2>
<p>K-å‡å€¼æœ€å°åŒ–é—®é¢˜ï¼Œæ˜¯è¦æœ€å°åŒ–æ‰€æœ‰çš„æ•°æ®ç‚¹ä¸å…¶æ‰€å…³è”çš„èšç±»ä¸­å¿ƒç‚¹ä¹‹é—´çš„è·ç¦»ä¹‹å’Œï¼Œå› æ­¤ K-å‡å€¼çš„ä»£ä»·å‡½æ•°ï¼ˆåˆç§°ç•¸å˜å‡½æ•°ï¼‰ä¸ºï¼š<br>
\[
J(c^{(1)},c^{(2)},\ldots,c^{(m)},\mu_1,\ldots,\mu_k) = \frac{1}{m}\sum^m_{i=1}\|X^{(i)}-\mu_{c^{(i)}}\|^2
\]<br>
å…¶ä¸­\(\mu_{c^{(i)}}\) ä»£è¡¨ä¸ \(x^{(i)}\) æœ€è¿‘çš„èšç±»ä¸­å¿ƒç‚¹ã€‚ ä¼˜åŒ–ç›®æ ‡ä¾¿æ˜¯æ‰¾å‡ºä½¿å¾—ä»£ä»·å‡½æ•°æœ€å°çš„\(c^{(1)},c^{(2)},...,c^{(m)}\) å’Œ \(u_1,u_2,...,u_k\)ã€‚</p>
<h2 id="k-zhi-de-xuan-ze">kå€¼çš„é€‰æ‹©</h2>
<p>åœ¨è¿è¡Œ K-å‡å€¼ç®—æ³•çš„ä¹‹å‰ï¼Œé¦–å…ˆè¦éšæœºåˆå§‹åŒ–æ‰€æœ‰çš„èšç±»ä¸­å¿ƒç‚¹ï¼š</p>
<ol>
<li>é€‰æ‹©ğ¾ &lt; ğ‘šï¼Œå³èšç±»ä¸­å¿ƒç‚¹çš„ä¸ªæ•°è¦å°äºæ‰€æœ‰è®­ç»ƒé›†å®ä¾‹çš„æ•°é‡ã€‚</li>
<li>éšæœºé€‰æ‹©ğ¾ä¸ªè®­ç»ƒå®ä¾‹ï¼Œç„¶åä»¤ğ¾ä¸ªèšç±»ä¸­å¿ƒåˆ†åˆ«ä¸è¿™ğ¾ä¸ªè®­ç»ƒå®ä¾‹ç›¸ç­‰ï¼ŒK-å‡å€¼çš„ä¸€ä¸ªé—®é¢˜åœ¨äºï¼Œå®ƒæœ‰å¯èƒ½ä¼šåœç•™åœ¨ä¸€ä¸ªå±€éƒ¨æœ€å°å€¼å¤„ï¼Œè€Œè¿™å–å†³äºåˆå§‹åŒ–çš„æƒ…å†µã€‚</li>
</ol>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œé€šå¸¸éœ€è¦å¤šæ¬¡è¿è¡Œ K-å‡å€¼ç®—æ³•ï¼Œæ¯ä¸€æ¬¡éƒ½é‡æ–°è¿›è¡Œéšæœºåˆå§‹åŒ–ï¼Œæœ€åå†æ¯”è¾ƒå¤šæ¬¡è¿è¡Œ K-å‡å€¼çš„ç»“æœï¼Œé€‰æ‹©ä»£ä»·å‡½æ•°æœ€å°çš„ç»“æœã€‚è¿™ç§æ–¹æ³•åœ¨ğ¾è¾ƒå°çš„æ—¶å€™ï¼ˆ2â€“10ï¼‰è¿˜æ˜¯å¯è¡Œçš„ï¼Œä½†æ˜¯å¦‚æœğ¾è¾ƒå¤§ï¼Œè¿™ä¹ˆåšä¹Ÿå¯èƒ½ä¸ä¼šæœ‰æ˜æ˜¾åœ°æ”¹å–„ã€‚</p>
<p>æ²¡æœ‰æ‰€è°“æœ€å¥½çš„é€‰æ‹©èšç±»æ•°çš„æ–¹æ³•ï¼Œé€šå¸¸æ˜¯éœ€è¦æ ¹æ®ä¸åŒçš„é—®é¢˜ï¼Œäººå·¥è¿›è¡Œé€‰æ‹©çš„ã€‚é€‰æ‹©çš„æ—¶å€™æ€è€ƒæˆ‘ä»¬è¿ç”¨ K-å‡å€¼ç®—æ³•èšç±»çš„åŠ¨æœºæ˜¯ä»€ä¹ˆã€‚æœ‰ä¸€ä¸ªå¯èƒ½ä¼šè°ˆåŠçš„æ–¹æ³•å«ä½œ<strong>è‚˜éƒ¨æ³•åˆ™</strong>ã€‚å…³äº<code>è‚˜éƒ¨æ³•åˆ™</code>ï¼Œæ‰€éœ€è¦åšçš„æ˜¯æ”¹å˜ğ¾å€¼ï¼Œä¹Ÿå°±æ˜¯èšç±»ç±»åˆ«æ•°ç›®çš„æ€»æ•°ã€‚ç”¨ä¸€ä¸ªèšç±»æ¥è¿è¡Œ K å‡å€¼èšç±»æ–¹æ³•ã€‚è¿™å°±æ„å‘³ç€ï¼Œæ‰€æœ‰çš„æ•°æ®éƒ½ä¼šåˆ†åˆ°ä¸€ä¸ªèšç±»é‡Œï¼Œç„¶åè®¡ç®—æˆæœ¬å‡½æ•°æˆ–è€…è®¡ç®—ç•¸å˜å‡½æ•°ğ½ã€‚ğ¾ä»£è¡¨èšç±»æ•°ç›®ã€‚</p>
<p><img src="/2020/06/08/machine_learning/clustering/00630Defly1g5b7pbaeavj30qo0cwtc9.jpg" alt></p>
<p>æˆ‘ä»¬å¯èƒ½ä¼šå¾—åˆ°ä¸€æ¡ç±»ä¼¼äºè¿™æ ·çš„æ›²çº¿ã€‚åƒä¸€ä¸ªäººçš„è‚˜éƒ¨ã€‚è¿™å°±æ˜¯<code>è‚˜éƒ¨æ³•åˆ™</code>æ‰€åšçš„ï¼Œæ¥çœ‹è¿™æ ·ä¸€ä¸ªå›¾ï¼Œçœ‹èµ·æ¥å°±å¥½åƒæœ‰ä¸€ä¸ªå¾ˆæ¸…æ¥šçš„è‚˜åœ¨é‚£å„¿ï¼Œå®ƒçš„ç•¸å˜å€¼ä¼šè¿…é€Ÿä¸‹é™ï¼Œä» 1 åˆ° 2ï¼Œä» 2 åˆ° 3 ä¹‹åï¼Œä½ ä¼šåœ¨ 3 çš„æ—¶å€™è¾¾åˆ°ä¸€ä¸ªè‚˜ç‚¹ã€‚åœ¨æ­¤ä¹‹åï¼Œç•¸å˜å€¼å°±ä¸‹é™çš„éå¸¸æ…¢ï¼Œçœ‹èµ·æ¥å°±åƒä½¿ç”¨ 3 ä¸ªèšç±»æ¥è¿›è¡Œèšç±»æ˜¯æ­£ç¡®çš„ï¼Œè¿™æ˜¯å› ä¸ºé‚£ä¸ªç‚¹æ˜¯æ›²çº¿çš„è‚˜ç‚¹ï¼Œç•¸å˜å€¼ä¸‹é™å¾—å¾ˆå¿«ï¼Œğ¾ = 3ä¹‹åå°±ä¸‹é™å¾—å¾ˆæ…¢ï¼Œé‚£ä¹ˆå°±é€‰ğ¾ = 3ã€‚åº”ç”¨<code>è‚˜éƒ¨æ³•åˆ™</code>å¾—åˆ°äº†ä¸€ä¸ªåƒä¸Šé¢è¿™æ ·çš„å›¾ï¼Œæ˜¯ç”¨æ¥é€‰æ‹©èšç±»ä¸ªæ•°çš„åˆç†æ–¹æ³•ã€‚</p>
<h2 id="knn-yu-k-means-qu-bie">KNNä¸K-meansåŒºåˆ«ï¼Ÿ</h2>
<p>Kæœ€è¿‘é‚»åˆ†ç±»ç®—æ³•ï¼Œæ˜¯ä¸€ä¸ªç†è®ºä¸Šæ¯”è¾ƒæˆç†Ÿçš„æ–¹æ³•ï¼Œä¹Ÿæ˜¯æœ€ç®€å•çš„æœºå™¨å­¦ä¹ ç®—æ³•ä¹‹ä¸€ã€‚</p>
<table>
<thead>
<tr>
<th style="text-align:left">KNN</th>
<th style="text-align:left">K-Means</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1.KNNæ˜¯åˆ†ç±»ç®—æ³•<br>2.å±äºç›‘ç£å­¦ä¹ <br>3.è®­ç»ƒæ•°æ®é›†æ˜¯å¸¦labelçš„æ•°æ®</td>
<td style="text-align:left">1.K-Meansæ˜¯èšç±»ç®—æ³•<br>2.å±äºéç›‘ç£å­¦ä¹ <br>3.è®­ç»ƒæ•°æ®é›†æ˜¯æ— labelçš„æ•°æ®ï¼Œæ˜¯æ‚ä¹±æ— ç« çš„ï¼Œç»è¿‡èšç±»åå˜å¾—æœ‰åºï¼Œå…ˆæ— åºï¼Œåæœ‰åºã€‚</td>
</tr>
<tr>
<td style="text-align:left">æ²¡æœ‰æ˜æ˜¾çš„å‰æœŸè®­ç»ƒè¿‡ç¨‹ï¼Œå±äºmemory based learning</td>
<td style="text-align:left">æœ‰æ˜æ˜¾çš„å‰æœŸè®­ç»ƒè¿‡ç¨‹</td>
</tr>
<tr>
<td style="text-align:left">Kçš„å«ä¹‰ï¼šä¸€ä¸ªæ ·æœ¬xï¼Œå¯¹å®ƒè¿›è¡Œåˆ†ç±»ï¼Œå°±ä»è®­ç»ƒæ•°æ®é›†ä¸­ï¼Œåœ¨xé™„è¿‘æ‰¾ç¦»å®ƒæœ€è¿‘çš„Kä¸ªæ•°æ®ç‚¹ï¼Œè¿™Kä¸ªæ•°æ®ç‚¹ï¼Œç±»åˆ«cå çš„ä¸ªæ•°æœ€å¤šï¼Œå°±æŠŠxçš„labelè®¾ä¸ºcã€‚</td>
<td style="text-align:left">Kçš„å«ä¹‰ï¼šKæ˜¯äººå·¥å›ºå®šå¥½çš„æ•°å­—ï¼Œå‡è®¾æ•°æ®é›†åˆå¯ä»¥åˆ†ä¸ºKä¸ªè”Ÿï¼Œé‚£ä¹ˆå°±åˆ©ç”¨è®­ç»ƒæ•°æ®æ¥è®­ç»ƒå‡ºè¿™Kä¸ªåˆ†ç±»ã€‚</td>
</tr>
</tbody>
</table>
<p><strong>ç›¸ä¼¼ç‚¹</strong></p>
<p>éƒ½åŒ…å«è¿™æ ·çš„è¿‡ç¨‹ï¼Œç»™å®šä¸€ä¸ªç‚¹ï¼Œåœ¨æ•°æ®é›†ä¸­æ‰¾ç¦»å®ƒæœ€è¿‘çš„ç‚¹ã€‚å³äºŒè€…éƒ½ç”¨åˆ°äº†NN(Nears Neighbor)ç®—æ³•æ€æƒ³ã€‚</p>
<h2 id="k-means-you-que-dian-ji-gai-jin">K-Meansä¼˜ç¼ºç‚¹åŠæ”¹è¿›</h2>
<p>k-meansï¼šåœ¨å¤§æ•°æ®çš„æ¡ä»¶ä¸‹ï¼Œä¼šè€—è´¹å¤§é‡çš„æ—¶é—´å’Œå†…å­˜ã€‚ ä¼˜åŒ–k-meansçš„å»ºè®®ï¼š</p>
<ol>
<li>
<p>å‡å°‘èšç±»çš„æ•°ç›®Kã€‚å› ä¸ºï¼Œæ¯ä¸ªæ ·æœ¬éƒ½è¦è·Ÿç±»ä¸­å¿ƒè®¡ç®—è·ç¦»ã€‚</p>
</li>
<li>
<p>å‡å°‘æ ·æœ¬çš„ç‰¹å¾ç»´åº¦ã€‚æ¯”å¦‚è¯´ï¼Œé€šè¿‡PCAç­‰è¿›è¡Œé™ç»´ã€‚</p>
</li>
<li>
<p>è€ƒå¯Ÿå…¶ä»–çš„èšç±»ç®—æ³•ï¼Œé€šè¿‡é€‰å–toyæ•°æ®ï¼Œå»æµ‹è¯•ä¸åŒèšç±»ç®—æ³•çš„æ€§èƒ½ã€‚</p>
</li>
<li>
<p>hadoopé›†ç¾¤ï¼ŒK-meansç®—æ³•æ˜¯å¾ˆå®¹æ˜“è¿›è¡Œå¹¶è¡Œè®¡ç®—çš„ã€‚</p>
</li>
<li>
<p>ç®—æ³•å¯èƒ½æ‰¾åˆ°å±€éƒ¨æœ€ä¼˜çš„èšç±»ï¼Œè€Œä¸æ˜¯å…¨å±€æœ€ä¼˜çš„èšç±»ã€‚ä½¿ç”¨æ”¹è¿›çš„äºŒåˆ†k-meansç®—æ³•ã€‚</p>
<p>äºŒåˆ†k-meansç®—æ³•ï¼šé¦–å…ˆå°†æ•´ä¸ªæ•°æ®é›†çœ‹æˆä¸€ä¸ªç°‡ï¼Œç„¶åè¿›è¡Œä¸€æ¬¡k-meansï¼ˆk=2ï¼‰ç®—æ³•å°†è¯¥ç°‡ä¸€åˆ†ä¸ºäºŒï¼Œå¹¶è®¡ç®—æ¯ä¸ªç°‡çš„è¯¯å·®å¹³æ–¹å’Œï¼Œé€‰æ‹©å¹³æ–¹å’Œæœ€å¤§çš„ç°‡è¿­ä»£ä¸Šè¿°è¿‡ç¨‹å†æ¬¡ä¸€åˆ†ä¸ºäºŒï¼Œç›´è‡³ç°‡æ•°è¾¾åˆ°ç”¨æˆ·æŒ‡å®šçš„kä¸ºæ­¢ï¼Œæ­¤æ—¶å¯ä»¥è¾¾åˆ°çš„å…¨å±€æœ€ä¼˜ã€‚</p>
</li>
</ol>
<h1 id="gao-si-hun-he-mo-xing-gmm">é«˜æ–¯æ··åˆæ¨¡å‹(GMM)</h1>
<h2 id="gmm-de-si-xiang">GMMçš„æ€æƒ³</h2>
<p>é«˜æ–¯æ··åˆæ¨¡å‹ä¹Ÿæ˜¯ä¸€ç§å¸¸è§çš„èšç±»ç®—æ³•ï¼Œä¸Kå‡å€¼ç®—æ³•ç±»ä¼¼ï¼ŒåŒæ ·ä½¿ç”¨äº†EMç®—æ³•è¿›è¡Œè¿­ä»£è®¡ç®—ã€‚é«˜æ–¯æ··åˆæ¨¡å‹å‡è®¾æ¯ä¸ªç°‡çš„æ•°æ®éƒ½æ˜¯ç¬¦åˆé«˜æ–¯åˆ†å¸ƒï¼ˆæ­£æ€åˆ†å¸ƒï¼‰çš„ï¼Œå½“å‰æ•°æ®å‘ˆç°çš„åˆ†å¸ƒå°±æ˜¯å„ä¸ªç°‡çš„é«˜æ–¯åˆ†å¸ƒå åŠ åœ¨ä¸€èµ·çš„ç»“æœã€‚</p>
<p>ç¬¬ä¸€å¼ å›¾æ˜¯ä¸€ä¸ªæ•°æ®åˆ†å¸ƒçš„æ ·ä¾‹ï¼Œå¦‚æœåªç”¨ä¸€ä¸ªé«˜æ–¯åˆ†å¸ƒæ¥æ‹Ÿåˆå›¾ä¸­çš„æ•°æ®ï¼Œå›¾ä¸­æ‰€ç¤ºçš„æ¤­åœ†å³ä¸ºé«˜æ–¯åˆ†å¸ƒçš„äºŒå€æ ‡å‡†å·®æ‰€å¯¹åº”çš„æ¤­åœ†ã€‚ç›´è§‚æ¥è¯´ï¼Œå›¾ä¸­çš„æ•°æ®æ˜æ˜¾åˆ†ä¸ºä¸¤ç°‡ï¼Œå› æ­¤åªç”¨ä¸€ä¸ªé«˜æ–¯åˆ†å¸ƒæ¥æ‹Ÿå’Œæ˜¯ä¸å¤ªåˆç†çš„ï¼Œéœ€è¦æ¨å¹¿åˆ°ç”¨å¤šä¸ªé«˜æ–¯åˆ†å¸ƒçš„å åŠ æ¥å¯¹æ•°æ®è¿›è¡Œæ‹Ÿåˆã€‚ç¬¬äºŒå¼ å›¾æ˜¯ç”¨ä¸¤ä¸ªé«˜æ–¯åˆ†å¸ƒçš„å åŠ æ¥æ‹Ÿåˆå¾—åˆ°çš„ç»“æœã€‚**è¿™å°±å¼•å‡ºäº†é«˜æ–¯æ··åˆæ¨¡å‹ï¼Œå³ç”¨å¤šä¸ªé«˜æ–¯åˆ†å¸ƒå‡½æ•°çš„çº¿å½¢ç»„åˆæ¥å¯¹æ•°æ®åˆ†å¸ƒè¿›è¡Œæ‹Ÿåˆã€‚**ç†è®ºä¸Šï¼Œ<strong>é«˜æ–¯æ··åˆæ¨¡å‹å¯ä»¥æ‹Ÿåˆå‡ºä»»æ„ç±»å‹çš„åˆ†å¸ƒ</strong>ã€‚</p>
<p><img src="/2020/06/08/machine_learning/clustering/00630Defly1g5b8mu9mjmj30iu0apjuh.jpg" alt></p>
<p><img src="/2020/06/08/machine_learning/clustering/00630Defly1g5b8ms101aj30id0aswhh.jpg" alt></p>
<p>é«˜æ–¯æ··åˆæ¨¡å‹çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼Œ<strong>å‡è®¾æ•°æ®å¯ä»¥çœ‹ä½œä»å¤šä¸ªé«˜æ–¯åˆ†å¸ƒä¸­ç”Ÿæˆå‡ºæ¥çš„</strong>ã€‚åœ¨è¯¥å‡è®¾ä¸‹ï¼Œæ¯ä¸ªå•ç‹¬çš„åˆ†æ¨¡å‹éƒ½æ˜¯æ ‡å‡†é«˜æ–¯æ¨¡å‹ï¼Œå…¶å‡å€¼ \(u_i\) å’Œæ–¹å·® \(\sum_i\) æ˜¯å¾…ä¼°è®¡çš„å‚æ•°ã€‚æ­¤å¤–ï¼Œæ¯ä¸ªåˆ†æ¨¡å‹éƒ½è¿˜æœ‰ä¸€ä¸ªå‚æ•° \(\pi_i\)ï¼Œå¯ä»¥ç†è§£ä¸ºæƒé‡æˆ–ç”Ÿæˆæ•°æ®çš„æ¦‚ç‡ã€‚é«˜æ–¯æ··åˆæ¨¡å‹çš„å…¬å¼ä¸ºï¼š<br>
\[
p(x) = \sum_i^k \pi_iN(x|\mu_i,\Sigma)
\]<br>
é€šå¸¸æˆ‘ä»¬å¹¶ä¸èƒ½ç›´æ¥å¾—åˆ°é«˜æ–¯æ··åˆæ¨¡å‹çš„å‚æ•°ï¼Œè€Œæ˜¯è§‚å¯Ÿåˆ°äº†ä¸€ç³»åˆ—æ•°æ®ç‚¹ï¼Œç»™å‡ºç±»åˆ«çš„æ•°é‡Kåï¼Œå¸Œæœ›æ±‚å¾—æœ€ä½³çš„Kä¸ªé«˜æ–¯åˆ†æ¨¡å‹ã€‚å› æ­¤ï¼Œé«˜æ–¯æ··åˆæ¨¡å‹çš„è®¡ç®—ï¼Œä¾¿æˆå¯»æ‰¾æœ€ä½³çš„å‡å€¼\(\mu\)ï¼Œæ–¹å·®\(\Sigma\)ã€æƒé‡\(\pi\)ï¼Œè¿™ç±»é—®é¢˜é€šå¸¸é€šè¿‡æœ€å¤§ä¼¼ç„¶ä¼°è®¡æ¥æ±‚è§£ã€‚é—æ†¾çš„æ˜¯ï¼Œæ­¤é—®é¢˜ä¸­ç›´æ¥ä½¿ç”¨æœ€å¤§ä¼¼ç„¶ä¼°è®¡ï¼Œå¾—åˆ°çš„æ˜¯ä¸€ ä¸ªå¤æ‚çš„éå‡¸å‡½æ•°ï¼Œç›®æ ‡å‡½æ•°æ˜¯å’Œçš„å¯¹æ•°ï¼Œéš¾ä»¥å±•å¼€å’Œå¯¹å…¶æ±‚åå¯¼ã€‚</p>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥ç”¨<strong>EMç®—æ³•</strong>ã€‚ EMç®—æ³•æ˜¯åœ¨æœ€å¤§åŒ–ç›®æ ‡å‡½æ•°æ—¶ï¼Œå…ˆå›ºå®šä¸€ä¸ªå˜é‡ä½¿æ•´ä½“å‡½æ•°å˜ä¸ºå‡¸ä¼˜åŒ–å‡½æ•°ï¼Œæ±‚å¯¼å¾—åˆ°æœ€å€¼ï¼Œç„¶ååˆ©ç”¨æœ€ä¼˜å‚æ•°æ›´æ–°è¢«å›ºå®šçš„å˜é‡ï¼Œè¿›å…¥ä¸‹ä¸€ä¸ªå¾ªç¯ã€‚å…·ä½“åˆ°é«˜æ–¯æ··åˆæ¨¡å‹çš„æ±‚è§£ï¼ŒEMç®—æ³•çš„è¿­ä»£è¿‡ç¨‹å¦‚ä¸‹ã€‚</p>
<p>é¦–å…ˆï¼Œåˆå§‹éšæœºé€‰æ‹©å„å‚æ•°çš„å€¼ã€‚ç„¶åï¼Œé‡å¤ä¸‹è¿°ä¸¤æ­¥ï¼Œç›´åˆ°æ”¶æ•›ã€‚</p>
<ul>
<li>Eæ­¥éª¤ã€‚æ ¹æ®å½“å‰çš„å‚æ•°ï¼Œè®¡ç®—æ¯ä¸ªç‚¹ç”±æŸä¸ªåˆ†æ¨¡å‹ç”Ÿæˆçš„æ¦‚ç‡ã€‚</li>
<li>Mæ­¥éª¤ã€‚ä½¿ç”¨Eæ­¥éª¤ä¼°è®¡å‡ºçš„æ¦‚ç‡ï¼Œæ¥æ”¹è¿›æ¯ä¸ªåˆ†æ¨¡å‹çš„å‡å€¼ï¼Œæ–¹å·®å’Œæƒé‡ã€‚</li>
</ul>
<blockquote>
<p>é«˜æ–¯æ··åˆæ¨¡å‹æ˜¯ä¸€ä¸ª<strong>ç”Ÿæˆå¼æ¨¡å‹</strong>ã€‚å¯ä»¥è¿™æ ·ç†è§£æ•°æ®çš„ç”Ÿæˆè¿‡ç¨‹ï¼Œå‡è®¾ä¸€ä¸ªæœ€ç®€å•çš„æƒ…å†µï¼Œå³åªæœ‰ä¸¤ä¸ªä¸€ç»´æ ‡å‡†é«˜æ–¯åˆ†å¸ƒçš„åˆ†æ¨¡å‹<em>N</em>(0,1)å’Œ<em>N</em>(5,1)ï¼Œå…¶æƒé‡åˆ†åˆ«ä¸º0.7å’Œ0.3ã€‚é‚£ä¹ˆï¼Œåœ¨ç”Ÿæˆç¬¬ä¸€ä¸ªæ•°æ®ç‚¹æ—¶ï¼Œå…ˆæŒ‰ç…§æƒé‡çš„æ¯”ä¾‹ï¼Œéšæœºé€‰æ‹©ä¸€ä¸ªåˆ†å¸ƒï¼Œæ¯”å¦‚é€‰æ‹©ç¬¬ä¸€ä¸ªé«˜æ–¯åˆ†å¸ƒï¼Œæ¥ç€ä»<em>N</em>(0,1)ä¸­ç”Ÿæˆä¸€ä¸ªç‚¹ï¼Œå¦‚âˆ’0.5ï¼Œä¾¿æ˜¯ç¬¬ä¸€ä¸ªæ•°æ®ç‚¹ã€‚åœ¨ç”Ÿæˆç¬¬äºŒä¸ªæ•°æ®ç‚¹æ—¶ï¼Œéšæœºé€‰æ‹©åˆ°ç¬¬äºŒä¸ªé«˜æ–¯åˆ†å¸ƒ<em>N</em>(5,1)ï¼Œç”Ÿæˆäº†ç¬¬äºŒä¸ªç‚¹4.7ã€‚å¦‚æ­¤å¾ªç¯æ‰§è¡Œï¼Œä¾¿ç”Ÿæˆå‡ºäº†æ‰€æœ‰çš„æ•°æ®ç‚¹ã€‚</p>
</blockquote>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¹¶ä¸çŸ¥é“æœ€ä½³çš„Kä¸ªé«˜æ–¯åˆ†å¸ƒçš„å„è‡ª3ä¸ªå‚æ•°ï¼Œä¹Ÿä¸çŸ¥é“æ¯ä¸ªæ•°æ®ç‚¹ç©¶ç«Ÿæ˜¯å“ªä¸ªé«˜æ–¯åˆ†å¸ƒç”Ÿæˆçš„ã€‚æ‰€ä»¥æ¯æ¬¡å¾ªç¯æ—¶ï¼Œå…ˆå›ºå®šå½“å‰çš„é«˜æ–¯åˆ†å¸ƒä¸å˜ï¼Œè·å¾—æ¯ä¸ªæ•°æ®ç‚¹ç”±å„ä¸ªé«˜æ–¯åˆ†å¸ƒç”Ÿæˆçš„æ¦‚ç‡ã€‚ç„¶åå›ºå®šè¯¥ç”Ÿæˆæ¦‚ç‡ä¸å˜ï¼Œæ ¹æ®æ•°æ®ç‚¹å’Œç”Ÿæˆæ¦‚ç‡ï¼Œè·å¾—ä¸€ä¸ªç»„æ›´ä½³çš„é«˜æ–¯åˆ†å¸ƒã€‚å¾ªç¯å¾€å¤ï¼Œç›´åˆ°å‚æ•°çš„ä¸å†å˜åŒ–ï¼Œæˆ–è€…å˜åŒ–éå¸¸å°æ—¶ï¼Œä¾¿å¾—åˆ°äº†æ¯”è¾ƒåˆç†çš„ä¸€ç»„é«˜æ–¯åˆ†å¸ƒã€‚</p>
<h1 id="gmm-yu-k-means-bi-jiao">GMMä¸K-Meansæ¯”è¾ƒ</h1>
<p>é«˜æ–¯æ··åˆæ¨¡å‹ä¸Kå‡å€¼ç®—æ³•çš„ç›¸åŒç‚¹æ˜¯ï¼š</p>
<ul>
<li>å®ƒä»¬éƒ½æ˜¯å¯ç”¨äºèšç±»çš„ç®—æ³•ï¼›</li>
<li>éƒ½éœ€è¦æŒ‡å®šKå€¼ï¼›</li>
<li>éƒ½æ˜¯ä½¿ç”¨EMç®—æ³•æ¥æ±‚è§£ï¼›</li>
<li>éƒ½å¾€å¾€åªèƒ½æ”¶æ•›äºå±€éƒ¨æœ€ä¼˜ã€‚</li>
</ul>
<p>è€Œå®ƒç›¸æ¯”äºK å‡å€¼ç®—æ³•çš„ä¼˜ç‚¹æ˜¯ï¼Œå¯ä»¥ç»™å‡ºä¸€ä¸ªæ ·æœ¬å±äºæŸç±»çš„æ¦‚ç‡æ˜¯å¤šå°‘ï¼›ä¸ä»…ä»…å¯ä»¥ç”¨äºèšç±»ï¼Œè¿˜å¯ä»¥ç”¨äºæ¦‚ç‡å¯†åº¦çš„ä¼°è®¡ï¼›å¹¶ä¸”å¯ä»¥ç”¨äºç”Ÿæˆæ–°çš„æ ·æœ¬ç‚¹ã€‚</p>
<h1 id="ju-lei-suan-fa-ru-he-ping-gu">èšç±»ç®—æ³•å¦‚ä½•è¯„ä¼°</h1>
<p>ç”±äºæ•°æ®ä»¥åŠéœ€æ±‚çš„å¤šæ ·æ€§ï¼Œæ²¡æœ‰ä¸€ç§ç®—æ³•èƒ½å¤Ÿé€‚ç”¨äºæ‰€æœ‰çš„æ•°æ®ç±»å‹ã€æ•°æ®ç°‡æˆ–åº”ç”¨åœºæ™¯ï¼Œä¼¼ä¹æ¯ç§æƒ…å†µéƒ½å¯èƒ½éœ€è¦ä¸€ç§ä¸åŒçš„è¯„ä¼°æ–¹æ³•æˆ–åº¦é‡æ ‡å‡†ã€‚ä¾‹å¦‚ï¼ŒKå‡å€¼èšç±»å¯ä»¥ç”¨è¯¯å·®å¹³æ–¹å’Œæ¥è¯„ä¼°ï¼Œä½†æ˜¯åŸºäºå¯†åº¦çš„æ•°æ®ç°‡å¯èƒ½ä¸æ˜¯çƒå½¢ï¼Œ è¯¯å·®å¹³æ–¹å’Œåˆ™ä¼šå¤±æ•ˆã€‚åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œåˆ¤æ–­èšç±»ç®—æ³•ç»“æœçš„å¥½å<strong>å¼ºçƒˆä¾èµ–äºä¸»è§‚è§£é‡Š</strong>ã€‚å°½ç®¡å¦‚æ­¤ï¼Œèšç±»ç®—æ³•çš„è¯„ä¼°è¿˜æ˜¯å¿…éœ€çš„ï¼Œå®ƒæ˜¯èšç±»åˆ†æä¸­ååˆ†é‡è¦çš„éƒ¨åˆ†ä¹‹ä¸€ã€‚</p>
<p>èšç±»è¯„ä¼°çš„ä»»åŠ¡æ˜¯ä¼°è®¡åœ¨æ•°æ®é›†ä¸Šè¿›è¡Œèšç±»çš„å¯è¡Œæ€§ï¼Œä»¥åŠèšç±»æ–¹æ³•äº§ç”Ÿç»“æœçš„è´¨é‡ã€‚è¿™ä¸€è¿‡ç¨‹åˆåˆ†ä¸ºä¸‰ä¸ªå­ä»»åŠ¡ã€‚</p>
<ol>
<li>
<p><strong>ä¼°è®¡èšç±»è¶‹åŠ¿ã€‚</strong></p>
<p>è¿™ä¸€æ­¥éª¤æ˜¯æ£€æµ‹æ•°æ®åˆ†å¸ƒä¸­æ˜¯å¦å­˜åœ¨ééšæœºçš„ç°‡ç»“æ„ã€‚å¦‚æœæ•°æ®æ˜¯åŸºæœ¬éšæœºçš„ï¼Œé‚£ä¹ˆèšç±»çš„ç»“æœä¹Ÿæ˜¯æ¯«æ— æ„ä¹‰çš„ã€‚æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿèšç±»è¯¯å·®æ˜¯å¦éšèšç±»ç±»åˆ«æ•°é‡çš„å¢åŠ è€Œå•è°ƒå˜åŒ–ï¼Œå¦‚æœæ•°æ®æ˜¯åŸºæœ¬éšæœºçš„ï¼Œå³ä¸å­˜åœ¨ééšæœºç°‡ç»“æ„ï¼Œé‚£ä¹ˆèšç±»è¯¯å·®éšèšç±»ç±»åˆ«æ•°é‡å¢åŠ è€Œå˜åŒ–çš„å¹…åº¦åº”è¯¥è¾ƒä¸æ˜¾è‘—ï¼Œå¹¶ä¸”ä¹Ÿæ‰¾ä¸åˆ°ä¸€ä¸ªåˆé€‚çš„Kå¯¹åº”æ•°æ®çš„çœŸå®ç°‡æ•°ã€‚</p>
</li>
<li>
<p><strong>åˆ¤å®šæ•°æ®ç°‡æ•°ã€‚</strong></p>
<p>ç¡®å®šèšç±»è¶‹åŠ¿ä¹‹åï¼Œéœ€è¦æ‰¾åˆ°ä¸çœŸå®æ•°æ®åˆ†å¸ƒæœ€ä¸ºå»åˆçš„ç°‡æ•°ï¼Œæ®æ­¤åˆ¤å®šèšç±»ç»“æœçš„è´¨é‡ã€‚æ•°æ®ç°‡æ•°çš„åˆ¤å®šæ–¹æ³•æœ‰å¾ˆå¤šï¼Œä¾‹å¦‚æ‰‹è‚˜æ³•å’ŒGap Statisticæ–¹ æ³•ã€‚éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œç”¨äºè¯„ä¼°çš„æœ€ä½³æ•°æ®ç°‡æ•°å¯èƒ½ä¸ç¨‹åºè¾“å‡ºçš„ç°‡æ•°æ˜¯ä¸åŒçš„ã€‚ ä¾‹å¦‚ï¼Œæœ‰äº›èšç±»ç®—æ³•å¯ä»¥è‡ªåŠ¨åœ°ç¡®å®šæ•°æ®çš„ç°‡æ•°ï¼Œä½†å¯èƒ½ä¸æˆ‘ä»¬é€šè¿‡å…¶ä»–æ–¹æ³•ç¡®å®šçš„æœ€ä¼˜æ•°æ®ç°‡æ•°æœ‰æ‰€å·®åˆ«ã€‚</p>
</li>
<li>
<p><strong>æµ‹å®šèšç±»è´¨é‡ã€‚</strong></p>
<p>åœ¨æ— ç›‘ç£çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è€ƒå¯Ÿç°‡çš„åˆ†ç¦»æƒ…å†µå’Œç°‡çš„ç´§å‡‘æƒ…å†µæ¥è¯„ä¼°èšç±»çš„æ•ˆæœã€‚å®šä¹‰è¯„ä¼°æŒ‡æ ‡å¯ä»¥å±•ç°é¢è¯•è€…å®é™…è§£å†³å’Œåˆ†æé—®é¢˜çš„èƒ½åŠ›ã€‚äº‹å®ä¸Šæµ‹é‡æŒ‡æ ‡å¯ä»¥æœ‰å¾ˆå¤šç§ï¼Œä»¥ä¸‹åˆ—å‡ºäº†å‡ ç§å¸¸ç”¨çš„åº¦é‡æŒ‡æ ‡ï¼š</p>
<p>è½®å»“ç³»æ•°ã€å‡æ–¹æ ¹æ ‡å‡†åå·®ã€Ræ–¹ï¼ˆR-Squareï¼‰ã€æ”¹è¿›çš„Hubertç»Ÿè®¡ã€‚</p>
</li>
</ol>
<h1 id="dai-ma">ä»£ç </h1>
<a class="btn" href="corpus_train.txt">
            <i class="fa fa-download"></i>è®­ç»ƒæ•°æ®
          </a>
<h2 id="k-means">k-means</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys <span class="keyword">as</span> sys</span><br><span class="line"><span class="comment">#reload(sys)</span></span><br><span class="line"><span class="comment">#sys.setdefaultencoding('utf-8')</span></span><br><span class="line"><span class="keyword">from</span> sklearn.cluster <span class="keyword">import</span> KMeans</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> feature_extraction</span><br><span class="line"><span class="keyword">from</span> sklearn.feature_extraction.text <span class="keyword">import</span> TfidfTransformer</span><br><span class="line"><span class="keyword">from</span> sklearn.feature_extraction.text <span class="keyword">import</span> CountVectorizer</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt </span><br><span class="line"><span class="keyword">from</span> matplotlib.font_manager <span class="keyword">import</span> FontProperties </span><br><span class="line"><span class="keyword">from</span> sklearn.cluster <span class="keyword">import</span> KMeans </span><br><span class="line"><span class="keyword">from</span> scipy.spatial.distance <span class="keyword">import</span> cdist </span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">vectorize the input documents</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tfidf_vector</span><span class="params">(corpus_path)</span>:</span></span><br><span class="line">    corpus_train=[]</span><br><span class="line">    <span class="comment">#åˆ©ç”¨train-corpusæå–ç‰¹å¾</span></span><br><span class="line">    target_train=[]</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> open(corpus_path):</span><br><span class="line">        line=line.strip().split(<span class="string">'\t'</span>)</span><br><span class="line">        <span class="keyword">if</span> len(line)==<span class="number">2</span>:</span><br><span class="line">            words=line[<span class="number">1</span>]</span><br><span class="line">            category=line[<span class="number">0</span>]</span><br><span class="line">            target_train.append(category)</span><br><span class="line">            corpus_train.append(words)</span><br><span class="line">    <span class="keyword">print</span> (<span class="string">"build train-corpus done!!"</span>)</span><br><span class="line">    count_v1= CountVectorizer(max_df=<span class="number">0.4</span>,min_df=<span class="number">0.01</span>)</span><br><span class="line">    counts_train = count_v1.fit_transform(corpus_train)  </span><br><span class="line">    </span><br><span class="line">    word_dict=&#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> index,word <span class="keyword">in</span> enumerate(count_v1.get_feature_names()):</span><br><span class="line">        word_dict[index]=word</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">print</span> (<span class="string">"the shape of train is "</span>)</span><br><span class="line">    <span class="keyword">print</span> (repr(counts_train.shape))</span><br><span class="line">    tfidftransformer = TfidfTransformer()</span><br><span class="line">    tfidf_train = tfidftransformer.fit(counts_train).transform(counts_train)</span><br><span class="line">    <span class="keyword">return</span> tfidf_train,word_dict</span><br><span class="line"></span><br><span class="line"><span class="comment"># topic cluster</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cluster_kmeans</span><span class="params">(tfidf_train,word_dict,cluster_docs,cluster_keywords,num_clusters)</span>:</span><span class="comment">#Kå‡å€¼åˆ†ç±»</span></span><br><span class="line">    f_docs=open(cluster_docs,<span class="string">'w+'</span>)</span><br><span class="line">    km = KMeans(n_clusters=num_clusters)</span><br><span class="line">    km.fit(tfidf_train)</span><br><span class="line">    clusters = km.labels_.tolist()</span><br><span class="line">    cluster_dict=&#123;&#125;</span><br><span class="line">    order_centroids = km.cluster_centers_.argsort()[:, ::<span class="number">-1</span>]      </span><br><span class="line">    doc=<span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> cluster <span class="keyword">in</span> clusters:</span><br><span class="line">        f_docs.write(str(str(doc))+<span class="string">','</span>+str(cluster)+<span class="string">'\n'</span>)</span><br><span class="line">        doc+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> cluster <span class="keyword">not</span> <span class="keyword">in</span> cluster_dict:</span><br><span class="line">            cluster_dict[cluster]=<span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            cluster_dict[cluster]+=<span class="number">1</span></span><br><span class="line">    f_docs.close()</span><br><span class="line">    cluster=<span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    f_clusterwords = open(cluster_keywords,<span class="string">'w+'</span>)</span><br><span class="line">    <span class="keyword">for</span> ind <span class="keyword">in</span> order_centroids: <span class="comment"># æ¯ä¸ªèšç±»é€‰ 50 ä¸ªè¯</span></span><br><span class="line">        words=[]</span><br><span class="line">        <span class="keyword">for</span> index <span class="keyword">in</span> ind[:<span class="number">50</span>]:</span><br><span class="line">            words.append(word_dict[index])</span><br><span class="line">        <span class="keyword">print</span> (cluster),(<span class="string">','</span>.join(words))</span><br><span class="line">        f_clusterwords.write(str(cluster)+<span class="string">'\t'</span>+<span class="string">','</span>.join(words)+<span class="string">'\n'</span>)</span><br><span class="line">        cluster+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">print</span> (<span class="string">'*****'</span>*<span class="number">5</span>)</span><br><span class="line">    f_clusterwords.close()</span><br><span class="line">    </span><br><span class="line"><span class="comment"># select the best cluster num</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">best_kmeans</span><span class="params">(tfidf_matrix,word_dict)</span>:</span>  </span><br><span class="line">    K = range(<span class="number">1</span>, <span class="number">10</span>) </span><br><span class="line">    meandistortions = [] </span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> K: </span><br><span class="line">        <span class="keyword">print</span> (k),(<span class="string">'****'</span>*<span class="number">5</span>)</span><br><span class="line">        kmeans = KMeans(n_clusters=k) </span><br><span class="line">        kmeans.fit(tfidf_matrix)    </span><br><span class="line">        meandistortions.append(sum(np.min(cdist(tfidf_matrix.toarray(), kmeans.cluster_centers_, <span class="string">'euclidean'</span>), axis=<span class="number">1</span>)) / tfidf_matrix.shape[<span class="number">0</span>]) </span><br><span class="line">    plt.plot(K, meandistortions, <span class="string">'bx-'</span>)</span><br><span class="line">    plt.grid(<span class="literal">True</span>) </span><br><span class="line">    plt.xlabel(<span class="string">'Number of clusters'</span>) </span><br><span class="line">    plt.ylabel(<span class="string">'Average within-cluster sum of squares'</span>) </span><br><span class="line">    plt.title(<span class="string">'Elbow for Kmeans clustering'</span>)</span><br><span class="line">    plt.show()</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">corpus_train = <span class="string">"corpus_train.txt"</span></span><br><span class="line">cluster_docs = <span class="string">"cluster_result_document.txt"</span></span><br><span class="line">cluster_keywords = <span class="string">"cluster_result_keyword.txt"</span></span><br><span class="line">num_clusters = <span class="number">7</span></span><br><span class="line">tfidf_train,word_dict=tfidf_vector(corpus_train)</span><br><span class="line">best_kmeans(tfidf_train,word_dict)</span><br><span class="line">cluster_kmeans(tfidf_train,word_dict,cluster_docs,cluster_keywords,num_clusters)</span><br></pre></td></tr></table></figure>
<h2 id="gmm">GMM</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> matplotlib.mlab <span class="keyword">as</span> mlab</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">EPS = <span class="number">0.0001</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate_data</span><span class="params">()</span>:</span>	</span><br><span class="line">  mu1 = <span class="number">2</span></span><br><span class="line">  mu2 = <span class="number">6</span></span><br><span class="line">  sigma1 = <span class="number">0.1</span></span><br><span class="line">  sigma2 = <span class="number">0.5</span></span><br><span class="line">  alpha1 = <span class="number">0.4</span></span><br><span class="line">  alpha2 = <span class="number">0.6</span></span><br><span class="line">  N = <span class="number">5000</span></span><br><span class="line">  N1 = int(alpha1 * N)</span><br><span class="line">  X = mat(zeros((N,<span class="number">1</span>)))</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> range(N1):</span><br><span class="line">    u1 = random.uniform(<span class="number">-1</span>,<span class="number">1</span>)</span><br><span class="line">    X[i] = u1 * sigma1 + mu1</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> range(N-N1):</span><br><span class="line">    u1 = random.uniform(<span class="number">-1</span>,<span class="number">1</span>)</span><br><span class="line">    X[i+N1] = u1 * sigma2 + mu2</span><br><span class="line">  <span class="keyword">return</span> X</span><br></pre></td></tr></table></figure>
<p>EMç®—æ³•</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">GMM</span><span class="params">(X)</span>:</span></span><br><span class="line">  k = <span class="number">2</span></span><br><span class="line">  N = len(X)</span><br><span class="line">  mu = np.random.rand(k,<span class="number">1</span>)</span><br><span class="line">  <span class="keyword">print</span> (str(<span class="string">'init mu='</span>))</span><br><span class="line">  <span class="keyword">print</span> (mu)</span><br><span class="line">  Posterior = mat(zeros((N,k)))	</span><br><span class="line">  sigma = np.random.rand(k,<span class="number">1</span>)</span><br><span class="line">  <span class="keyword">print</span> (str(<span class="string">'init sigma='</span>))</span><br><span class="line">  <span class="keyword">print</span> (sigma)</span><br><span class="line">  alpha = np.random.rand(k,<span class="number">1</span>)</span><br><span class="line">  dominator = <span class="number">0</span></span><br><span class="line">  numerator = <span class="number">0</span></span><br><span class="line">  <span class="keyword">print</span> (str(<span class="string">'init alpha='</span>))</span><br><span class="line">  <span class="keyword">print</span> (alpha)</span><br><span class="line">  <span class="comment">#å…ˆæ±‚åéªŒæ¦‚ç‡</span></span><br><span class="line">  <span class="comment">#print (sigma)</span></span><br><span class="line">  <span class="keyword">for</span> it <span class="keyword">in</span> range(<span class="number">1000</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(N):</span><br><span class="line">      dominator = <span class="number">0</span></span><br><span class="line">      <span class="keyword">for</span> j <span class="keyword">in</span> range(k):</span><br><span class="line">        dominator = dominator + np.exp(<span class="number">-1.0</span>/(<span class="number">2.0</span>*sigma[j]) * (X[i] - mu[j])**<span class="number">2</span>)</span><br><span class="line">        <span class="comment">#print -1.0/(2.0*sigma[j]),(X[i] - mu[j])**2,-1.0/(2.0*sigma[j]) * (X[i] - mu[j])**2,np.exp(-1.0/(2.0*sigma[j]) * (X[i] - mu[j])**2)</span></span><br><span class="line">        <span class="comment">#return</span></span><br><span class="line">      <span class="keyword">for</span> j <span class="keyword">in</span> range(k):</span><br><span class="line">        numerator = np.exp(<span class="number">-1.0</span>/(<span class="number">2.0</span>*sigma[j]) * (X[i] - mu[j])**<span class="number">2</span>)</span><br><span class="line">        Posterior[i,j] = numerator/dominator			</span><br><span class="line">    oldmu = copy.deepcopy(mu)</span><br><span class="line">    oldalpha = copy.deepcopy(alpha)</span><br><span class="line">    oldsigma = copy.deepcopy(sigma)</span><br><span class="line">    <span class="comment">#æœ€å¤§åŒ–	</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(k):</span><br><span class="line">      numerator = <span class="number">0</span></span><br><span class="line">      dominator = <span class="number">0</span></span><br><span class="line">      <span class="keyword">for</span> i <span class="keyword">in</span> range(N):</span><br><span class="line">        numerator = numerator + Posterior[i,j] * X[i]</span><br><span class="line">        dominator = dominator + Posterior[i,j]</span><br><span class="line">      mu[j] = numerator/dominator</span><br><span class="line">      alpha[j] = dominator/N</span><br><span class="line">      tmp = <span class="number">0</span></span><br><span class="line">      <span class="keyword">for</span> i <span class="keyword">in</span> range(N):</span><br><span class="line">        tmp = tmp + Posterior[i,j] * (X[i] - mu[j])**<span class="number">2</span></span><br><span class="line">        <span class="comment">#print tmp,Posterior[i,j],(X[i] - mu[j])**2 </span></span><br><span class="line">      sigma[j] = tmp/dominator</span><br><span class="line">      <span class="comment">#print (tmp)</span></span><br><span class="line">      <span class="comment">#print (dominator)</span></span><br><span class="line">      <span class="comment">#print (sigma[j])</span></span><br><span class="line">    <span class="keyword">if</span> ((abs(mu - oldmu)).sum() &lt; EPS) <span class="keyword">and</span> \</span><br><span class="line">      ((abs(alpha - oldalpha)).sum() &lt; EPS) <span class="keyword">and</span> \</span><br><span class="line">      ((abs(sigma - oldsigma)).sum() &lt; EPS):</span><br><span class="line">        <span class="keyword">print</span> (str(<span class="string">'final mu='</span>)) </span><br><span class="line">        <span class="keyword">print</span> (str(mu))</span><br><span class="line">        <span class="keyword">print</span> (str(<span class="string">'final sigma='</span>))</span><br><span class="line">        <span class="keyword">print</span> (str(sigma))</span><br><span class="line">        <span class="keyword">print</span> (str(<span class="string">'final alpha='</span>))</span><br><span class="line">        <span class="keyword">print</span> (str(alpha))</span><br><span class="line">        <span class="keyword">print</span> (it)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">X = generate_data()</span><br><span class="line">plt.hist(X, <span class="number">30</span>, normed=<span class="literal">True</span>)</span><br><span class="line">plt.show()</span><br><span class="line">GMM(X)</span><br></pre></td></tr></table></figure>

    </div>

    
    
    <div>
  
    <div style="text-align:center;color:#bfbfbf;font-size:16px;">
      <span>-------- æœ¬æ–‡ç»“æŸ </span>
      <i class="fa fa-coffee"></i>
      <span> æ„Ÿè°¢é˜…è¯» --------</span>
    </div>
  
</div>
        <div class="reward-container">
  <div></div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    é¼“åŠ±ä¸€ä¸‹
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/wechat.png" alt="Li Zhen å¾®ä¿¡æ”¯ä»˜">
        <p>å¾®ä¿¡æ”¯ä»˜</p>
      </div>
      
      <div style="display: inline-block;">
        <img src="/images/ali.png" alt="Li Zhen æ”¯ä»˜å®">
        <p>æ”¯ä»˜å®</p>
      </div>

  </div>
</div>


      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/06/07/deeplearning/loss/circle_loss/" rel="prev" title="Circle Loss">
      <i class="fa fa-chevron-left"></i> Circle Loss
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/06/09/machine_learning/knn/" rel="next" title="kè¿‘é‚»">
      kè¿‘é‚» <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#ju-lei-suan-fa-du-shi-wu-jian-du-xue-xi-ma"><span class="nav-number">1.</span> <span class="nav-text">èšç±»ç®—æ³•éƒ½æ˜¯æ— ç›‘ç£å­¦ä¹ å—?</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#k-means-suan-fa"><span class="nav-number">2.</span> <span class="nav-text">k-meansç®—æ³•</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#suan-fa-guo-cheng"><span class="nav-number">2.1.</span> <span class="nav-text">ç®—æ³•è¿‡ç¨‹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sun-shi-han-shu"><span class="nav-number">2.2.</span> <span class="nav-text">æŸå¤±å‡½æ•°</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#k-zhi-de-xuan-ze"><span class="nav-number">2.3.</span> <span class="nav-text">kå€¼çš„é€‰æ‹©</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#knn-yu-k-means-qu-bie"><span class="nav-number">2.4.</span> <span class="nav-text">KNNä¸K-meansåŒºåˆ«ï¼Ÿ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#k-means-you-que-dian-ji-gai-jin"><span class="nav-number">2.5.</span> <span class="nav-text">K-Meansä¼˜ç¼ºç‚¹åŠæ”¹è¿›</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#gao-si-hun-he-mo-xing-gmm"><span class="nav-number">3.</span> <span class="nav-text">é«˜æ–¯æ··åˆæ¨¡å‹(GMM)</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#gmm-de-si-xiang"><span class="nav-number">3.1.</span> <span class="nav-text">GMMçš„æ€æƒ³</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#gmm-yu-k-means-bi-jiao"><span class="nav-number">4.</span> <span class="nav-text">GMMä¸K-Meansæ¯”è¾ƒ</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#ju-lei-suan-fa-ru-he-ping-gu"><span class="nav-number">5.</span> <span class="nav-text">èšç±»ç®—æ³•å¦‚ä½•è¯„ä¼°</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#dai-ma"><span class="nav-number">6.</span> <span class="nav-text">ä»£ç </span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#k-means"><span class="nav-number">6.1.</span> <span class="nav-text">k-means</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#gmm"><span class="nav-number">6.2.</span> <span class="nav-text">GMM</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <a href='/'>
    <img class="site-author-image" itemprop="image" alt="Li Zhen"
      src="/images/snoppy.jpeg">
  </a>
  <p class="site-author-name" itemprop="name">Li Zhen</p>
  <div class="site-description" itemprop="description">ä»–ï¼Œä¸è®ºåœ¨æˆå¹´è¿˜æ˜¯åœ¨å°æ—¶å€™ï¼Œå¿…é¡»è¸ä¸Šä¸€æ¡æä¸ºè‰°è‹¦çš„é“è·¯ï¼Œä¸è¿‡è¿™æ˜¯ä¸€æ¡æœ€å¯é çš„é“è·¯ã€‚</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">89</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">26</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">67</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/jeffery0628" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;jeffery0628" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:jeffery.lee.0628@gmail.com" title="é‚®ç®± â†’ mailto:jeffery.lee.0628@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>é‚®ç®±</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2018 â€“ 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heartbeat"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Li Zhen</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">ç«™ç‚¹æ€»å­—æ•°ï¼š</span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">1.1m</span>
</div>

        
<div class="busuanzi-count">
    <span class="site-uv">
      æˆ‘çš„ç¬¬ <span class="busuanzi-value" id="busuanzi_value_site_uv"></span> ä½æœ‹å‹ï¼Œ
    </span>
    <span class="site-pv">
      å†ç» <span class="busuanzi-value" id="busuanzi_value_site_pv"></span> æ¬¡å›çœ¸æ‰ä¸ä½ ç›¸é‡
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/velocity-animate@1/velocity.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/velocity-animate@1/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

  






  <script src="/js/activate-power-mode.min.js"></script>
  <script>
    POWERMODE.colorful = true;
    POWERMODE.shake = false;
    document.body.addEventListener('input', POWERMODE);
  </script>


 

<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/moment.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment-precise-range-plugin@1.3.0/moment-precise-range.min.js"></script>
<script>
  function timer() {
    var ages = moment.preciseDiff(moment(),moment(20180101,"YYYYMMDD"));
    ages = ages.replace(/years?/, "å¹´");
    ages = ages.replace(/months?/, "æœˆ");
    ages = ages.replace(/days?/, "å¤©");
    ages = ages.replace(/hours?/, "å°æ—¶");
    ages = ages.replace(/minutes?/, "åˆ†");
    ages = ages.replace(/seconds?/, "ç§’");
    ages = ages.replace(/\d+/g, '<span style="color:#1890ff">$&</span>');
    div.innerHTML = `æˆ‘å·²åœ¨æ­¤ç­‰å€™ä½  ${ages}`;
  }
  var div = document.createElement("div");
  //æ’å…¥åˆ°copyrightä¹‹å
  var copyright = document.querySelector(".copyright");
  document.querySelector(".footer-inner").insertBefore(div, copyright.nextSibling);
  timer();
  setInterval("timer()",1000)
</script>


<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>

<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/valine@1/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'tChTbEIggDSVcdhPBUf0MFxW-gzGzoHsz',
      appKey     : 'sJ6xUiFnifEDIIfnj3Ut9zy1',
      placeholder: "ç•™ä¸‹ä½ çš„å°è„šå°å§ï¼",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '8' || 10,
      visitor    : true,
      lang       : 'zh-cn' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</body>
</html>
